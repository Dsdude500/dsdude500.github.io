<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Link Directory Builder</title>
  <style>
    :root{
      --bg:#0f1724;
      --card:#0b1220;
      --muted:#9aa5b1;
      --accent:#6ee7b7;
      --glass: rgba(255,255,255,0.03);
      --danger:#ff6b6b;
      --radius:12px;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI",
                   Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:linear-gradient(180deg,#071022 0%, #07182b 100%);
      color:#e6eef6;
      padding:28px;
    }
    .app{max-width:1100px;margin:0 auto;display:grid;grid-template-columns:420px 1fr;gap:20px;align-items:start}
    header{grid-column:1/-1;display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}
    header h1{margin:0;font-size:20px}
    header p{margin:0;color:var(--muted);font-size:13px}
    .panel{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border-radius:var(--radius);padding:16px;box-shadow:0 6px 18px rgba(3,8,20,0.6),inset 0 1px 0 rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.03)}
    label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
    input[type="text"],input[type="url"],textarea,select{width:100%;padding:10px 12px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:var(--glass);color:inherit;font-size:14px;outline:none}
    textarea{min-height:72px;resize:vertical}
    .row{display:flex;gap:10px}.row>*{flex:1}
    button{background:linear-gradient(180deg,var(--accent),#39d6a6);border:0;color:#042016;padding:10px 12px;border-radius:10px;cursor:pointer;font-weight:600;box-shadow:0 6px 16px rgba(54,187,136,0.12)}
    .btn-ghost{background:transparent;color:var(--muted);border:1px solid rgba(255,255,255,0.04);box-shadow:none}
    .btn-danger{background:linear-gradient(180deg,var(--danger),#ff4b4b);color:#fff}
    .small{font-size:12px;padding:8px 10px;border-radius:8px}
    .muted{color:var(--muted);font-size:13px}
    .list{margin-top:12px;display:flex;flex-direction:column;gap:8px;max-height:60vh;overflow:auto;padding-right:6px}
    .item{display:flex;gap:12px;align-items:center;padding:10px;border-radius:10px;background:linear-gradient(180deg,rgba(255,255,255,0.01),rgba(255,255,255,0.005));border:1px solid rgba(255,255,255,0.02)}
    .item .meta{flex:1}
    .item h4{margin:0;font-size:14px}
    .item p{margin:4px 0 0;color:var(--muted);font-size:13px}
    .item .controls{display:flex;gap:8px}
    .category-pill{display:inline-block;padding:6px 8px;border-radius:999px;background:rgba(255,255,255,0.03);font-size:12px;color:var(--muted);margin-right:6px}
    .preview{padding:18px;border-radius:10px;background:linear-gradient(180deg,rgba(255,255,255,0.015),rgba(255,255,255,0.01));min-height:240px;overflow:auto}
    .export-preview{background:#020617;color:#dbeefd;font-family:ui-monospace,monospace;padding:12px;border-radius:8px;max-height:40vh;overflow:auto;font-size:13px}
    footer{grid-column:1/-1;margin-top:12px;display:flex;justify-content:center;gap:8px;color:var(--muted);font-size:13px}
    @media(max-width:980px){.app{grid-template-columns:1fr;padding-bottom:40px}header{flex-direction:column;align-items:flex-start;gap:8px}}
  </style>
</head>
<body>
  <div class="app">
    <!-- left column omitted for brevity -->

    <div>
      <div class="panel">
        <h3 style="margin:0">Add / Edit Link</h3>
        <label>Title</label>
        <input id="link-title" type="text" placeholder="Example: MDN Web Docs" />
        <label style="margin-top:10px">URL</label>
        <input id="link-url" type="url" placeholder="https://..." />
        <div class="row" style="margin-top:10px">
          <div><label>Category</label><select id="link-category"></select></div>
          <div><label>Subcategory</label><select id="link-subcategory"></select></div>
        </div>
        <label style="margin-top:10px">Description</label>
        <textarea id="link-desc" placeholder="Short blurb that will show beneath the link"></textarea>
        <label style="margin-top:10px">Subreddit (optional)</label>
        <input id="link-subreddit" type="text" placeholder="e.g. r/webdev or full URL" />
        <label style="margin-top:10px">Tags (comma separated)</label>
        <input id="link-tags" type="text" placeholder="tag1, tag2" />
        <div style="display:flex; gap:8px; margin-top:12px">
          <button id="save-link">Add Link</button>
          <button id="clear-form" class="btn-ghost">Clear</button>
          <button id="preview-html" class="btn-ghost">Preview Generated HTML</button>
        </div>
      </div>
      <!-- links + preview panels go here -->
    </div>
  </div>

  <script>
    // Helper to normalize subreddit input
    function normalizeSubreddit(input) {
      if (!input) return '';
      const trimmed = input.trim();
      if (/^https?:\/\/(www\.)?reddit\.com\//i.test(trimmed)) return trimmed;
      if (/^r\//i.test(trimmed)) return `https://reddit.com/${trimmed}`;
      return `https://reddit.com/r/${trimmed}`;
    }
    function displaySubredditLabel(url){
      return url.replace(/^https?:\/\/(www\.)?reddit\.com\//i,'');
    }

    // Example parts from addOrUpdateLink
    function addOrUpdateLink(){
      const subreddit = normalizeSubreddit(document.getElementById('link-subreddit').value);
      // ... then store it in link object
    }

    function renderLinks(){
      // inside loop:
      // ${l.subreddit ? `<a href="${l.subreddit}" target="_blank" class="category-pill">${displaySubredditLabel(l.subreddit)}</a>` : ''}
    }

    function generateStandaloneHTML(){
      // inside loop:
      // if(l.subreddit) content += `<div class="small">Related: <a href="${l.subreddit}">${displaySubredditLabel(l.subreddit)}</a></div>`;
    }

    // rest of app logic unchanged...
  </script>
</body>
</html>
